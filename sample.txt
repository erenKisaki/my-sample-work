import java.io.*;
import java.net.HttpURLConnection;
import java.net.URL;

public class ArtifactDownloader {

    private void saveArtifactToFile(String arifactoryUrl) throws Exception {
        URL repositoryUrl = new URL(arifactoryUrl);
        HttpURLConnection connection = (HttpURLConnection) repositoryUrl.openConnection();
        connection.addRequestProperty("X-JFrog-Art-Api", env.getProperty("arifactoryApiKey"));
        connection.setRequestMethod("GET");
        connection.connect();

        try (InputStream inputStream = connection.getInputStream()) {
            String fileName = "artifact-" + System.currentTimeMillis() + ".jar"; // Create a new file name with a timestamp
            File outputFile = new File("src/main/resources/" + fileName);

            try (FileOutputStream fileOutputStream = new FileOutputStream(outputFile)) {
                byte[] buffer = new byte[4096];
                int bytesRead;

                while ((bytesRead = inputStream.read(buffer)) != -1) {
                    fileOutputStream.write(buffer, 0, bytesRead);
                }
            }
        } finally {
            connection.disconnect();
        }
    }
}
