    private static int findLineBreakIndex(String line, PDType1Font font, float fontSize, float maxWidth) throws IOException {
        int breakIndex = line.length();
        float textWidth = font.getStringWidth(line) / 1000 * fontSize;
        
        if (textWidth <= maxWidth) {
            return breakIndex;
        }

        for (int i = 1; i < line.length(); i++) {
            String subLine = line.substring(0, i);
            float subWidth = font.getStringWidth(subLine) / 1000 * fontSize;
            if (subWidth > maxWidth) {
                breakIndex = i - 1;
                break;
            }
        }

        return breakIndex;
    }
